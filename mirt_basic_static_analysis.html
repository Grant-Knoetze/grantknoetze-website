<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <!--Google site verification-->
    <meta name="google-site-verification" content="ZNGAVpLH57ubR17YFkS1kr9uWstVE5-tEmb0eAVlEX0" />
    <!--End Google site verification-->
    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NSLWXR2R');</script>
    <!-- End Google Tag Manager -->
    <!--Google Adsense-->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4126413092594705"
    crossorigin="anonymous"></script>
     <!--End Google Adsense-->
    <title>Malware Incident Response - Basic Static Analysis</title>
    <meta http-equiv="x-ua-Compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--Apple Developer and Safari Webkits-->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <!--Apple Developer and Safari Webkits End-->
    <meta name="description"
        content="This is my professional blog.">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" />
    <!-- Google Fonts Roboto -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet" />
    <!-- MDB -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.10.1/mdb.min.css" rel="stylesheet" />
    <!--<link rel="stylesheet" href="mdb.min.css" />-->
    <!-- Custom styles -->
    <!--<link rel="stylesheet" href="style.css" />-->
</head>

<body>
    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NSLWXR2R"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <!--Main Navigation-->
    <header>
        <!-- Intro settings -->
        <style>
            #intro {
                /* Margin to fix overlapping fixed navbar */
                margin-top: 58px;
            }

            @media (max-width: 991px) {
                #intro {
                    /* Margin to fix overlapping fixed navbar */
                    margin-top: 45px;
                }
            }
        </style>
        <!-- Navbar -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
            <!--Container wrapper-->
            <div class="container-fluid">
                <!-- Toggle button -->
                <button class="navbar-toggler" type="button" data-mdb-toggle="collapse"
                    data-mdb-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <i class="fas fa-bars"></i>
                </button>
                <!-- Collapsible wrapper -->
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <!--Left links-->
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link" href="index.html">Advanced Red Teaming - APT and Adversary Emulation</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="phishing.html">Phishing Techniques</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="initial_access.html">Initial Access Techniques</a>
                        </li>
                        <!--<li class="nav-item">
                            <a class="nav-link" href="purple_team_cyber_range.html">Purple Team Cyber Range</a>
                        </li>-->
                        <li class="nav-item">
                            <a class="nav-link" href="maintaining_persistence.html">Maintaining Persistence</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="defense_evasion.html">Defense Evasion</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="incident_response_pshell_hunting.html">Incident Response - PowerShell Hunting</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="incident_response_detecting_malicious_documents_with_sysmon.html">Incident Response - Detecting Malicious Documents With Sysmon</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="mirt_basic_static_analysis.html">Malware Incident Response - Basic Static Analysis</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="memory_forensics.html">Incident Response - Memory Forensics</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="index_base64.html">Base 64 Encoder/Decoder</a>
                        </li>
                    </ul>
                    <!--Left links-->
                </div>
                <!-- Collapsible wrapper -->
        </nav>
        <!-- Navbar -->
        
        <div id="intro" class="p-5 text-center bg-light">

            <h1 class="display-5">Malware Incident Response - Basic Static Analysis</h1>

        </div>
        <!-- Jumbotron -->
    </header>
    <!--Main Navigation-->
    <!--Main layout-->

    <main class="mt-4 mb-5">
        <div class="container">
            <!--Grid row-->
            <div class="row">
                <!--Grid column-->
                <div class="col-md-8 mb-4">
                    <!--Section: Post mdb-->
                    <section class="border-bottom mb-4">
                        <!---- <img src="https://mdbootstrap.com/img/Photos/Slides/img%20(144).jpg" class="img-fluid shadow-2-strong rounded mb-4" alt="" /> -->

                        <div class="row align-items-center mb-4">
                            <div class="col-lg-6 text-center text-lg-start mb-3 m-lg-0">
                                <img src="IMG-9879-copy-2.webp" class="rounded shadow-1-strong me-2" height="35" alt=""
                                    loading="lazy" loading="lazy" />
                                <span><strong>Blog by: Grant Knoetze</strong> </span>
                                <!---- <a href="" class="text-dark">Grant Knoetze</a> -->
                            </div>
                    </section>
                    <!--Section: Post mdb-->

                    <!--Section: Text-->
                    <section>
                        <div class="Introduction">
                            <h2 class="display-6">Important Strings</h2>
                            <p class="lead">

                            <p class="lead">Basic static analysis of the malware sample can be used to discover more about the malware, 
                                for example, look for important strings such as:
                                <ul>
                                    <li class="lead"><strong>URL's, including C&C's</strong>
                                    </li>
                                    <li class="lead"><strong>PowerShell and command prompt commands</strong>
                                    <li class="lead"><strong>Configurations for the malware</strong>
                                    </li>
                                    <li class="lead"><strong>Registry entries - possibly for disabling services or maintaining persistence</strong>
                                    </li>
                                    <li class="lead"><strong>API's - useful for describing the malwares functionality</strong>
                                    </li>
                                    <li class="lead"><strong>PDB (created during the visual studio compilation process) strings - can help in identifying the malware by name, and connecting it 
                                        with other variants or families of malware
                                    </strong>
                                    </li> 
                                    <li class="lead"><strong>Formatted (printf in C++) strings 
                                    </strong></li>
                                <li class="lead"><strong>Mutexes 
                                </strong> </li>
                                <li class="lead"><strong>Processes to inject into, AV processes (detection and termination thereof)
                                </strong> </li>
                                <li class="lead"><strong>File paths that reveal funcionalities 
                                </strong> </li>
                                <li class="lead"><strong>Passwords and encryption keys
                                </strong> </li>
                                <li class="lead"><strong>Public keys (for PKA encryption)
                                </strong> </li>
                            </ul>
                            </p>
                        </div>
                        <div class="PE Headers">
                            <h2 class="display-6">PE (portable executable) Header</h2>
                            <p class="lead">The PE Header, or "executable files header", is an important place to begin when you start with 
                                basic static analysis of a malware sample. There are various open source and free tools available for this task, 
                                as well as paid versions, for this demonstration, I will be using the free version of PEStudio. The executable file is 
                                organized into a specific structure, the PE header contains useful information, for example, the PE Header sets the stage 
                                for the running process by including for example import and export tables detailing the API's and DLL's necessary for the
                                program to run.
                                <ul>
                                    <li class="lead"><strong>PE header separates the code and data into sections</strong>
                                    </li>
                                    <li class="lead"><strong>Each section has separate permissions.</strong>
                                    <li class="lead"><strong>The file is expandable in memory</strong>
                                    </li>
                                    <li class="lead"><strong>Supports dynamic linking</strong>
                                    </li>
                                    <li class="lead"><strong>Supports relocation</strong>
                                    </li>
                                    <li class="lead"><strong>Portable for any subsystem, processor, and type of file.
                                    </strong>
                                    </li> 
                            </ul>                       
                            </p>
                            <h2 class="display-6">A Note On Unpacking the Malware Sample</h2>
                            <p class="lead">Here I will use UPX to unpack the malware sample before loading it into 
                                PEStudio for basic static analysis. Take note of the sections columns, which are not available
                                before the sample has been unpacked, but become available immediately after unpacking.
                                I will be using a sample of Pony AKA Fariet malware:
                                <a href="https://any.run/malware-trends/pony"
                                target="_blank" rel="noopener">Pony Malware Any.Runs.</a>
                            </p><img src="UPX_cmd.webp" class="img-fluid" shadow-1-strong rounded mb-4 loading="lazy"
                            style="width: 100%" alt="Unpacking the sample with UPX" /><br></br>
                            <img src="Pony_packed.webp" class="img-fluid" shadow-1-strong rounded mb-4 loading="lazy"
                                style="width: 100%" alt="Packed pony malware" /><br></br>
                                <img src="Pony_unpacked.webp" class="img-fluid" shadow-1-strong rounded mb-4 loading="lazy"
                                style="width: 100%" alt="Unpacked pony malware" /><br></br>
                            <p class="lead">
                            </p>
                            <h2 class="display-6">Searching for Strings in PE Studio</h2>
                            <p class="lead">After opening the unpacked sample in PEStudio, I select the strings section from the left hand pane,
                                and go through the section of strings looking for interesting and important strings, the first thing that I notice 
                                is a GUID, that looks like a Windows unique identifier, I copy this string and search in Google, which immediately 
                                returns a result for Pony AKA Fariet malware:
                            </p>
                            <img src="PE_studio_strings_1.webp" class="img-fluid" shadow-1-strong rounded mb-4 loading="lazy"
                            style="width: 100%" alt="C&C 1" /><br></br>
                            <img src="GUID_pony_search.webp" class="img-fluid" shadow-1-strong rounded mb-4 loading="lazy"
                            style="width: 100%" alt="Pony GUID search 1" /><br></br>
                            <img src="GUID_pony_search_results.webp" class="img-fluid" shadow-1-strong rounded mb-4 loading="lazy"
                            style="width: 100%" alt="GUID pony search 2" /><br></br>
                            <p class="lead">I continue to search in the strings, and I notice a URL that I investigate in Google, and I am returned 
                                the (now removed from the web) C&C server of the malware:
                            </p>
                           
                            <img src="PE_studio_strings_2.webp" class="img-fluid" shadow-1-strong rounded mb-4 loading="lazy"
                            style="width: 100%" alt="C&C 2" /><br></br>
                            <img src="Pony_c2.webp" class="img-fluid" shadow-1-strong rounded mb-4 loading="lazy"
                            style="width: 100%" alt="C&C 3" /><br></br>
                        </div>
                    </section>
                    <!--Section: Share buttons-->
                    <section class="text-center border-top border-bottom py-4 mb-4">
                        <p><strong>Share with your network</strong></p>
                        <a href="https://twitter.com" class="btn btn-primary m-1" role="button" target="_blank"
                            rel="noopener">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="https://www.linkedin.com" class="btn btn-primary m-1" role="button" target="_blank"
                            rel="noopener">
                            <i class="fab fa-linkedin"></i>
                        </a>
                    </section>
                    <!--Section: Share buttons-->

                    <!--Section: Author-->
                    <section class="border-bottom mb-4 pb-4">
                        <div class="row">
                            <div class="col-3">
                               <!---- <img src="IMG-9879-copy-2.webp" loading="lazy" class="img-fluid shadow-1-strong rounded"
                                    alt="Author" />
                            </div>-->

                           <!---- <div class="col-9">-->
                            <section class="text-left border-top border-bottom py-4 mb-4">
                                <p class="mb-2"><strong>Grant Knoetze</strong></p>
                                <p>
                                    IT Support Specialist Cybersecurity Analyst Software Developer
                                </p>
                            </div></section>
                    <!--Section: Author-->

 

                
                </div>
                <!--Grid column-->

                <!--Grid column-->
                <div class="col-md-4 mb-4">
                    <!--Section: Sidebar-->
                    <section class="sticky-top" style="top: 80px;">
                    </section>
                    <!--Section: Ad-->
                    <section class="text-center border-bottom pb-4 mb-4">
                        <div class="bg-image hover-overlay ripple mb-4">
                            <!---- <img src="" class="img-fluid" />-->
                            <a href="https://github.com/Grant-Knoetze/c--red-team-code" target="_blank" rel="noopener">
                                <div class="mask" style="background-color: rgba(57, 192, 237, 0.2);"></div>
                            </a>
                        </div>
                        <h5>Useful Code for Red Teaming</h5>
                        <p class="lead"> This is code that I wrote to help me with red teaming. Disclaimer - Nothing
                            on this page is intended for malicious purposes, anything that you do with any code is
                            <em>your own
                                responsibility</em>, <b>never engage a target without written permission in the form of
                                    a signed contract.</b>
                        </p>
                        <a href="https://github.com/Grant-Knoetze/c--red-team-code" class="btn btn-primary m-1"
                            role="button" rel="nofollow" target="_blank" rel="noopener">
                            <i class="fab fa-github"></i>
                        </a>
                    </section>
                    <!--Section: Sidebar-->
                </div>
                <!--Grid column-->
            </div>
            <!--Grid row-->
        </div>
    </main>
    <!--Main layout-->

    <!--Footer-->
    <footer class="bg-light text-lg-start">
        <hr class="m-0" />

        <div class="text-center py-4 align-items-center">
            <p>Follow me on social media</p>
            <a href="https://twitter.com/KnoetzeGrant" class="btn btn-primary m-1" role="button" rel="nofollow"
                target="_blank" rel="noopener">
                <i class="fab fa-twitter"></i>
            </a>
            <a href="https://github.com/Grant-Knoetze" class="btn btn-primary m-1" role="button" rel="nofollow"
                target="_blank" rel="noopener">
                <i class="fab fa-github"></i>
            </a>
            <a href="https://www.linkedin.com/in/grant-knoetze-563b0b1b6/" class="btn btn-primary m-1" role="button"
                rel="nofollow" target="_blank" rel="noopener">
                <i class="fab fa-linkedin"></i>
            </a>
        </div>
        <!-- Copyright -->
        <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2);">
            © 2025 Copyright: Grant Knoetze
        </div>
        <!-- Copyright -->
    </footer>
    <!--Footer-->
    <!-- MDB -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.10.1/mdb.min.js"></script>
    <!-- Custom scripts -->
    <script type="text/javascript"></script>
        <!-- Google Tag Manager -->
        <script type="text/javascript"
        src="https://gc.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=FyAvnV26jgbcxptBeyJ0P1rB6D8Gp4pcXgqZAmh1c9gh8ZhfdxA4DafLZmI1xkzHmm3zxtFCJeLRHK96tqGvfmaywWn3Kty6w0MV4C805MMkGIRUnrIGrRIim13trBSPPfGPzRmeaVnCnntOIY7BHbdR36EVWuuLYGySkYSKiVtwdrU5jEZtgQh_uWXM6x8y"
        charset="UTF-8"></script>
    <link rel="stylesheet" crossorigin="anonymous"
        href="https://gc.kis.v2.scr.kaspersky-labs.com/E3E8934C-235A-4B0E-825A-35A08381A191/abn/main.css?attr=aHR0cHM6Ly9nYXJnb3lsZS5hc2Vydi5jby56YToyMDgzL2Nwc2VzczYxNDg3OTM3NzMvZG93bmxvYWQ_c2tpcGVuY29kZT0xJmZpbGU9JTJmaG9tZSUyZmdyYW50Y2NiJTJmcHVibGljX2h0bWwlMmZpbmRleC5odG1s" />
    <script>
        (function (w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({
                'gtm.start': new Date().getTime(),
                event: 'gtm.js'
            });
            var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s),
                dl = l != 'dataLayer' ? '&l=' + l : '';
            j.async = true;
            j.src =
                'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-K4QRS88');
    </script>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FETHGQJWZF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-FETHGQJWZF');
</script>
    <!-- End Google Tag Manager -->
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K4QRS88" height="0" width="0"
        style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
  <!--Core Web Vitals-->
<script type="module">
    import {onCLS, onINP, onLCP} from 'https://unpkg.com/web-vitals@4?module';
    function sendToGoogleAnalytics({name, delta, id}) {
  // Assumes the global `gtag()` function exists, see:
  // https://developers.google.com/analytics/devguides/collection/gtagjs
  gtag('event', name, {
    event_category: 'Web Vitals',
    // Google Analytics metrics must be integers, so the value is rounded.
    // For CLS the value is first multiplied by 1000 for greater precision
    // (note: increase the multiplier for greater precision if needed).
    value: Math.round(name === 'CLS' ? delta * 1000 : delta),
    // The `id` value will be unique to the current page load. When sending
    // multiple values from the same page (e.g. for CLS), Google Analytics can
    // compute a total by grouping on this ID (note: requires `eventLabel` to
    // be a dimension in your report).
    event_label: id,
    // Use a non-interaction event to avoid affecting bounce rate.
    non_interaction: true,
  });
}

onCLS(sendToGoogleAnalytics);
onINP(sendToGoogleAnalytics);
onLCP(sendToGoogleAnalytics);
  
    onCLS(console.log);
    onINP(console.log);
    onLCP(console.log);
  </script>
  <!--Core Web Vitals End-->
</body>

</html>