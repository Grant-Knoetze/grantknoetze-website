<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <!--Google site verification-->
    <meta name="google-site-verification" content="ZNGAVpLH57ubR17YFkS1kr9uWstVE5-tEmb0eAVlEX0" />
    <!--End Google site verification-->
    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NSLWXR2R');</script>
    <!-- End Google Tag Manager -->
    <!--Google Adsense-->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4126413092594705"
    crossorigin="anonymous"></script>
     <!--End Google Adsense-->
    <title>Incident Response - Memory Forensics</title>
    <meta http-equiv="x-ua-Compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--Apple Developer and Safari Webkits-->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <!--Apple Developer and Safari Webkits End-->
    <meta name="description"
        content="This is my professional blog.">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" />
    <!-- Google Fonts Roboto -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet" />
    <!-- MDB -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.10.1/mdb.min.css" rel="stylesheet" />
    <!--<link rel="stylesheet" href="mdb.min.css" />-->
    <!-- Custom styles -->
    <!--<link rel="stylesheet" href="style.css" />-->
</head>

<body>
    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NSLWXR2R"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <!--Main Navigation-->
    <header>
        <!-- Intro settings -->
        <style>
            #intro {
                /* Margin to fix overlapping fixed navbar */
                margin-top: 58px;
            }

            @media (max-width: 991px) {
                #intro {
                    /* Margin to fix overlapping fixed navbar */
                    margin-top: 45px;
                }
            }
        </style>
        <!-- Navbar -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
            <!--Container wrapper-->
            <div class="container-fluid">
                <!-- Toggle button -->
                <button class="navbar-toggler" type="button" data-mdb-toggle="collapse"
                    data-mdb-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <i class="fas fa-bars"></i>
                </button>
                <!-- Collapsible wrapper -->
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <!--Left links-->
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link" href="index.html">Advanced Red Teaming - APT and Adversary Emulation</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="phishing.html">Phishing Techniques</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="initial_access.html">Initial Access Techniques</a>
                        </li>
                        <!--<li class="nav-item">
                            <a class="nav-link" href="purple_team_cyber_range.html">Purple Team Cyber Range</a>
                        </li>-->
                         <li class="nav-item">
                            <a class="nav-link" href="maintaining_persistence.html">Maintaining Persistence</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="defense_evasion.html">Defense Evasion</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="incident_response_pshell_hunting.html">Incident Response - PowerShell Hunting</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="incident_response_detecting_malicious_documents_with_sysmon.html">Incident Response - Detecting Malicious Documents With Sysmon</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="mirt_basic_static_analysis.html">Malware Incident Response - Basic Static Analysis</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="memory_forensics.html">Incident Response - Memory Forensics</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="index_base64.html">Base 64 Encoder/Decoder</a>
                        </li>
                    </ul>
                    <!--Left links-->
                </div>
                <!-- Collapsible wrapper -->
        </nav>
        <!-- Navbar -->
        
        <div id="intro" class="p-5 text-center bg-light">

            <h1 class="display-5">Incident Response - Memory Forensics</h1>

        </div>
        <!-- Jumbotron -->
    </header>
    <!--Main Navigation-->
    <!--Main layout-->

    <main class="mt-4 mb-5">
        <div class="container">
            <!--Grid row-->
            <div class="row">
                <!--Grid column-->
                <div class="col-md-8 mb-4">
                    <!--Section: Post mdb-->
                    <section class="border-bottom mb-4">
                        <!---- <img src="https://mdbootstrap.com/img/Photos/Slides/img%20(144).jpg" class="img-fluid shadow-2-strong rounded mb-4" alt="" /> -->

                        <div class="row align-items-center mb-4">
                            <div class="col-lg-6 text-center text-lg-start mb-3 m-lg-0">
                                <img src="IMG-9879-copy-2.webp" class="rounded shadow-1-strong me-2" height="35" alt=""
                                    loading="lazy" loading="lazy" />
                                <span><strong>Blog by: Grant Knoetze</strong> </span>
                                <!---- <a href="" class="text-dark">Grant Knoetze</a> -->
                            </div>
                    </section>
                    <!--Section: Post mdb-->

                    <!--Section: Text-->
                    <section>
                        <div class="Introduction">
                            <h2 class="display-6">When to Perform Memory Forensics</h2>
                            <p class="lead">The decision to make a memory dump (aquisition), is taken when there has been an incident. 
                                There must be some suspicion that the machine has been compromised. Memory dumps and memory forensics can 
                                be very helpful in the incident response process.
                            
                            First, get a memory dump (memory aquisition), using a tool such as dumpit.</p>

    
                            <h2 class="display-6">Volatility3</h2>
                            <p class="lead">
                              Volatility3 is an open source tool that we will use for memory forensics.</p>
                        </div>
                        <div class="Running processes">
                            <h2 class="display-6">Investigating Processes</h2>
                            <p class="lead">
                               One of the first things that we will do is investigate the running processes. Volatile info including the 
                               process list etc. To get the running processes run the PsList command to do so.
                            </p>
                            <img src="Volatility_pslist.webp" class="img-fluid" shadow-1-strong rounded mb-4 loading="lazy"
                            style="width: 100%" alt="Process list in Volatility3" /><br></br>
                            <p class="lead">The Pstree command will be helpful in finding suspicious processes launching other processes.
                                As we can see in the snap below, WINWORD.EXE is launching rundll32.exe which we can assume is registering 
                                a DLL, in this case a malicious one (IER.dll from the same incident referred to in my previous post)
                            </p>
                            <img src="Volatility_pstree.webp" class="img-fluid" shadow-1-strong rounded mb-4 loading="lazy"
                            style="width: 100%" alt="Process tree WINWORD.EXE launching rundll.32" /><br></br>
                            <img src="Volatility_pstree_Winword_rundll32.webp" class="img-fluid" shadow-1-strong rounded mb-4 loading="lazy"
                            style="width: 100%" alt="Process tree WINWORD.EXE launching rundll.32 2" /><br></br>
                            <p class="lead">Notice that rundll32.exe's parent process ID (PPID) is the same as the process ID (PID) 
                                of WINWORD.EXE.
                            </p>
                            <img src="Volatility_pstree_Winword_rundll32_PID.webp" class="img-fluid" shadow-1-strong rounded mb-4 loading="lazy"
                            style="width: 100%" alt="Process tree WINWORD.EXE launching rundll.32 3" /><br></br>
                            <h2 class="display-6">Display loaded DLL's</h2>
                            <p class="lead">
                                To display a process's loaded DLLs, use the dlllist command. It walks the doubly-linked list of
                                 _LDR_DATA_TABLE_ENTRY structures which is pointed to by the PEB's (process environment block) InLoadOrderModuleList. 
                                 DLLs are automatically added to this list when a process calls LoadLibrary (or some derivative such as LdrLoadDll)
                                  and they aren't removed until FreeLibrary is called and the reference count reaches zero. 
                                  The load count column tells you if a DLL was statically loaded (i.e. as a result of being in the exe or another DLL's 
                                  import table) or dynamically loaded

                                  I run the dlllist command and output the contents to a txt file, which I then search using grep for the PID of the suspicious
                                  process that I have previously gathered, to see which DLL's were loaded by the process.

                                  The DLL's can be dumped and you can run the strings.Strings command to search for important strings.
                             </p>
                             <img src="Dll_list.webp" class="img-fluid" shadow-1-strong rounded mb-4 loading="lazy"
                            style="width: 100%" alt="Process tree WINWORD.EXE launching rundll.32 3" /><br></br>
                           
                            <h2 class="display-6">Using Malfind</h2>
                            <p class="lead">The malfind command helps find hidden or injected code/DLLs in user mode memory, based on descriptions such as 
                                virtual address descriptor (VAD) tags and page permissions. The purpose of malfind is to find DLL's that standard methods and
                                tools do not see.

                                Malfind will look for PAGE_EXECUTE_READWRITE in private memory.
                            </p>
                            <img src="Malfind_1.webp" class="img-fluid" shadow-1-strong rounded mb-4 loading="lazy"
                            style="width: 100%" alt="Malfind_1" /><br></br>
                            <img src="Pe_svchost_exe.webp" class="img-fluid" shadow-1-strong rounded mb-4 loading="lazy"
                            style="width: 100%" alt="Malfind_2" /><br></br>
                            
                            
                            <h2 class="display-6"></h2>
                            <h2 class="display-6"></h2>
                            <p class="lead">
                            </p>
                            
                            </div>
                    </section>
                    <!--Section: Share buttons-->
                    <section class="text-center border-top border-bottom py-4 mb-4">
                        <p><strong>Share with your network</strong></p>
                        <a href="https://twitter.com" class="btn btn-primary m-1" role="button" target="_blank"
                            rel="noopener">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="https://www.linkedin.com" class="btn btn-primary m-1" role="button" target="_blank"
                            rel="noopener">
                            <i class="fab fa-linkedin"></i>
                        </a>
                    </section>
                    <!--Section: Share buttons-->

                    <!--Section: Author-->
                    <section class="border-bottom mb-4 pb-4">
                        <div class="row">
                            <div class="col-3">
                               <!---- <img src="IMG-9879-copy-2.webp" loading="lazy" class="img-fluid shadow-1-strong rounded"
                                    alt="Author" />
                            </div>-->

                           <!---- <div class="col-9">-->
                            <section class="text-left border-top border-bottom py-4 mb-4">
                                <p class="mb-2"><strong>Grant Knoetze</strong></p>
                                <p>
                                    IT Support Specialist Cybersecurity Analyst Software Developer
                                </p>
                            </div></section>
                    <!--Section: Author-->

 

                
                </div>
                <!--Grid column-->

                <!--Grid column-->
                <div class="col-md-4 mb-4">
                    <!--Section: Sidebar-->
                    <section class="sticky-top" style="top: 80px;">
                    </section>
                    <!--Section: Ad-->
                    <section class="text-center border-bottom pb-4 mb-4">
                        <div class="bg-image hover-overlay ripple mb-4">
                            <!---- <img src="" class="img-fluid" />-->
                            <a href="https://github.com/Grant-Knoetze/c--red-team-code" target="_blank" rel="noopener">
                                <div class="mask" style="background-color: rgba(57, 192, 237, 0.2);"></div>
                            </a>
                        </div>
                        <h5>Useful Code for Red Teaming</h5>
                        <p class="lead"> This is code that I wrote to help me with red teaming. Disclaimer - Nothing
                            on this page is intended for malicious purposes, anything that you do with any code is
                            <em>your own
                                responsibility</em>, <b>never engage a target without written permission in the form of
                                    a signed contract.</b>
                        </p>
                        <a href="https://github.com/Grant-Knoetze/c--red-team-code" class="btn btn-primary m-1"
                            role="button" rel="nofollow" target="_blank" rel="noopener">
                            <i class="fab fa-github"></i>
                        </a>
                    </section>
                    <!--Section: Sidebar-->
                </div>
                <!--Grid column-->
            </div>
            <!--Grid row-->
        </div>
    </main>
    <!--Main layout-->

    <!--Footer-->
    <footer class="bg-light text-lg-start">
        <hr class="m-0" />

        <div class="text-center py-4 align-items-center">
            <p>Follow me on social media</p>
            <a href="https://twitter.com/KnoetzeGrant" class="btn btn-primary m-1" role="button" rel="nofollow"
                target="_blank" rel="noopener">
                <i class="fab fa-twitter"></i>
            </a>
            <a href="https://github.com/Grant-Knoetze" class="btn btn-primary m-1" role="button" rel="nofollow"
                target="_blank" rel="noopener">
                <i class="fab fa-github"></i>
            </a>
            <a href="https://www.linkedin.com/in/grant-knoetze-563b0b1b6/" class="btn btn-primary m-1" role="button"
                rel="nofollow" target="_blank" rel="noopener">
                <i class="fab fa-linkedin"></i>
            </a>
        </div>
        <!-- Copyright -->
        <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2);">
            © 2025 Copyright: Grant Knoetze
        </div>
        <!-- Copyright -->
    </footer>
    <!--Footer-->
    <!-- MDB -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.10.1/mdb.min.js"></script>
    <!-- Custom scripts -->
    <script type="text/javascript"></script>
        <!-- Google Tag Manager -->
        <script type="text/javascript"
        src="https://gc.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=FyAvnV26jgbcxptBeyJ0P1rB6D8Gp4pcXgqZAmh1c9gh8ZhfdxA4DafLZmI1xkzHmm3zxtFCJeLRHK96tqGvfmaywWn3Kty6w0MV4C805MMkGIRUnrIGrRIim13trBSPPfGPzRmeaVnCnntOIY7BHbdR36EVWuuLYGySkYSKiVtwdrU5jEZtgQh_uWXM6x8y"
        charset="UTF-8"></script>
    <link rel="stylesheet" crossorigin="anonymous"
        href="https://gc.kis.v2.scr.kaspersky-labs.com/E3E8934C-235A-4B0E-825A-35A08381A191/abn/main.css?attr=aHR0cHM6Ly9nYXJnb3lsZS5hc2Vydi5jby56YToyMDgzL2Nwc2VzczYxNDg3OTM3NzMvZG93bmxvYWQ_c2tpcGVuY29kZT0xJmZpbGU9JTJmaG9tZSUyZmdyYW50Y2NiJTJmcHVibGljX2h0bWwlMmZpbmRleC5odG1s" />
    <script>
        (function (w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({
                'gtm.start': new Date().getTime(),
                event: 'gtm.js'
            });
            var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s),
                dl = l != 'dataLayer' ? '&l=' + l : '';
            j.async = true;
            j.src =
                'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-K4QRS88');
    </script>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FETHGQJWZF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-FETHGQJWZF');
</script>
    <!-- End Google Tag Manager -->
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K4QRS88" height="0" width="0"
        style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
  <!--Core Web Vitals-->
<script type="module">
    import {onCLS, onINP, onLCP} from 'https://unpkg.com/web-vitals@4?module';
    function sendToGoogleAnalytics({name, delta, id}) {
  // Assumes the global `gtag()` function exists, see:
  // https://developers.google.com/analytics/devguides/collection/gtagjs
  gtag('event', name, {
    event_category: 'Web Vitals',
    // Google Analytics metrics must be integers, so the value is rounded.
    // For CLS the value is first multiplied by 1000 for greater precision
    // (note: increase the multiplier for greater precision if needed).
    value: Math.round(name === 'CLS' ? delta * 1000 : delta),
    // The `id` value will be unique to the current page load. When sending
    // multiple values from the same page (e.g. for CLS), Google Analytics can
    // compute a total by grouping on this ID (note: requires `eventLabel` to
    // be a dimension in your report).
    event_label: id,
    // Use a non-interaction event to avoid affecting bounce rate.
    non_interaction: true,
  });
}

onCLS(sendToGoogleAnalytics);
onINP(sendToGoogleAnalytics);
onLCP(sendToGoogleAnalytics);
  
    onCLS(console.log);
    onINP(console.log);
    onLCP(console.log);
  </script>
  <!--Core Web Vitals End-->
</body>

</html>